{"ast":null,"code":"var _jsxFileName = \"/mnt/c/Users/ajtwi/git/MusicJournal/music-journal/src/client/src/withAuth.js\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\nimport router from 'next/router';\nimport { firebase } from './initFirebase';\nimport cookies from 'next-cookies';\n\nconst withAuth = Component => {\n  return class extends React.Component {\n    static async getInitialProps(ctx) {\n      const {\n        firebaseToken\n      } = cookies(ctx);\n\n      if (!firebaseToken) {\n        return {};\n      }\n\n      firebase.auth().signInWithCustomToken(firebaseToken).catch(function (error) {});\n      const user = firebase.auth().currentUser;\n      return {\n        user\n      };\n    }\n\n    constructor(props) {\n      super(props);\n      this.state = {\n        status: 'LOADING'\n      };\n    }\n\n    componentDidMount() {\n      if (this.props.user) {\n        this.setState({\n          status: 'SIGNED_IN'\n        });\n      } else {\n        router.push('/login');\n      }\n    }\n\n    renderContent() {\n      const {\n        status\n      } = this.state;\n\n      if (status == 'LOADING') {\n        return __jsx(\"h1\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 45,\n            columnNumber: 24\n          }\n        }, \"Loading ......\");\n      } else if (status == 'SIGNED_IN') {\n        return __jsx(Component, _extends({}, this.props, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 47,\n            columnNumber: 24\n          }\n        }));\n      }\n    }\n\n    render() {\n      return __jsx(React.Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 17\n        }\n      }, this.renderContent());\n    }\n\n  };\n};\n\nexport default withAuth;","map":{"version":3,"sources":["/mnt/c/Users/ajtwi/git/MusicJournal/music-journal/src/client/src/withAuth.js"],"names":["React","router","firebase","cookies","withAuth","Component","getInitialProps","ctx","firebaseToken","auth","signInWithCustomToken","catch","error","user","currentUser","constructor","props","state","status","componentDidMount","setState","push","renderContent","render"],"mappings":";;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,SAASC,QAAT,QAAyB,gBAAzB;AACA,OAAOC,OAAP,MAAoB,cAApB;;AAEA,MAAMC,QAAQ,GAAIC,SAAD,IAAe;AAE5B,SAAO,cAAcL,KAAK,CAACK,SAApB,CAA8B;AAEjC,iBAAaC,eAAb,CAA6BC,GAA7B,EAAkC;AAC9B,YAAM;AAAEC,QAAAA;AAAF,UAAoBL,OAAO,CAACI,GAAD,CAAjC;;AAEA,UAAI,CAACC,aAAL,EAAoB;AACd,eAAO,EAAP;AACL;;AACDN,MAAAA,QAAQ,CAACO,IAAT,GAAgBC,qBAAhB,CAAsCF,aAAtC,EACKG,KADL,CACW,UAAUC,KAAV,EAAiB,CACvB,CAFL;AAIA,YAAMC,IAAI,GAAGX,QAAQ,CAACO,IAAT,GAAgBK,WAA7B;AAEA,aAAO;AAAED,QAAAA;AAAF,OAAP;AACH;;AAEDE,IAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,YAAMA,KAAN;AAEA,WAAKC,KAAL,GAAa;AACTC,QAAAA,MAAM,EAAE;AADC,OAAb;AAGH;;AAEDC,IAAAA,iBAAiB,GAAG;AAChB,UAAI,KAAKH,KAAL,CAAWH,IAAf,EAAqB;AACjB,aAAKO,QAAL,CAAc;AACVF,UAAAA,MAAM,EAAE;AADE,SAAd;AAGH,OAJD,MAIO;AACHjB,QAAAA,MAAM,CAACoB,IAAP,CAAY,QAAZ;AACH;AACJ;;AACDC,IAAAA,aAAa,GAAG;AACZ,YAAM;AAAEJ,QAAAA;AAAF,UAAa,KAAKD,KAAxB;;AACA,UAAIC,MAAM,IAAI,SAAd,EAAyB;AACrB,eAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BAAP;AACH,OAFD,MAEO,IAAIA,MAAM,IAAI,WAAd,EAA2B;AAC9B,eAAO,MAAC,SAAD,eAAe,KAAKF,KAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAP;AACH;AACJ;;AACDO,IAAAA,MAAM,GAAG;AACL,aACI,MAAC,KAAD,CAAO,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACK,KAAKD,aAAL,EADL,CADJ;AAKH;;AAhDgC,GAArC;AAkDH,CApDD;;AAuDA,eAAelB,QAAf","sourcesContent":["import React from 'react';\nimport router from 'next/router';\nimport { firebase } from './initFirebase';\nimport cookies from 'next-cookies'\n\nconst withAuth = (Component) => {\n\n    return class extends React.Component {\n\n        static async getInitialProps(ctx) {\n            const { firebaseToken } = cookies(ctx);\n\n            if (!firebaseToken) {\n                  return {}\n            }\n            firebase.auth().signInWithCustomToken(firebaseToken)\n                .catch(function (error) {\n                });\n\n            const user = firebase.auth().currentUser;\n\n            return { user };\n        }\n\n        constructor(props) {\n            super(props);\n            \n            this.state = {\n                status: 'LOADING',\n            }\n        }\n\n        componentDidMount() {\n            if (this.props.user) {\n                this.setState({\n                    status: 'SIGNED_IN'\n                });\n            } else {\n                router.push('/login');\n            }\n        }\n        renderContent() {\n            const { status } = this.state;\n            if (status == 'LOADING') {\n                return <h1>Loading ......</h1>;\n            } else if (status == 'SIGNED_IN') {\n                return <Component {...this.props} />\n            }\n        }\n        render() {\n            return (\n                <React.Fragment>\n                    {this.renderContent()}\n                </React.Fragment>\n            );\n        }\n    };\n}\n\n\nexport default withAuth;\n"]},"metadata":{},"sourceType":"module"}