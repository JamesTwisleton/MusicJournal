{"ast":null,"code":"export default async function handler(req, res) {\n  if (!req.body.song || !req.body.memorytext) {\n    return 'save memory request missing key data';\n  }\n\n  const firebaseAdmin = require('firebase-admin');\n\n  const firebase = require('firebase');\n\n  const serviceAccount = require('../../service-account.json');\n\n  const {\n    v4: uuid\n  } = require('uuid');\n\n  if (!firebaseAdmin.apps.length) {\n    firebaseAdmin.initializeApp({\n      credential: firebaseAdmin.credential.cert(serviceAccount),\n      databaseURL: process.env.FIREBASE_DATABASE_URL\n    });\n  }\n\n  const user = firebase.auth().currentUser;\n  const messageUuid = uuid();\n  const saveSong = firebaseAdmin.database().ref(`/memory/${user.uid}/${messageUuid}/song`).set(req.body.song);\n  const saveText = firebaseAdmin.database().ref(`/memory/${user.uid}/${messageUuid}/text`).set(req.body.memorytext);\n  await Promise.all([saveSong, saveText]);\n  res.writeHead(301, {\n    Location: '/'\n  }).end();\n}","map":null,"metadata":{},"sourceType":"module"}