{"ast":null,"code":"const Cookies = require('cookies');\n\nconst crypto = require('crypto');\n\nconst SpotifyWebApi = require('spotify-web-api-node');\n\nconst Spotify = new SpotifyWebApi({\n  clientId: process.env.SPOTIFY_CLIENT_ID,\n  clientSecret: process.env.SPOTIFY_CLIENT_SECRET,\n  redirectUri: process.env.AUTH_REDIRECT_URL\n});\nconst OAUTH_SCOPES = ['user-read-email', 'user-read-recently-played'];\nexport default function handler(req, res) {\n  const cookies = new Cookies(req, res);\n  const state = req.cookies.state || crypto.randomBytes(20).toString('hex');\n  cookies.set('verificationState', state.toString());\n  cookies.set('maxAge', 3600000);\n  cookies.set('secure', true);\n  cookies.set('httpOnly', true);\n  const authorizeURL = Spotify.createAuthorizeURL(OAUTH_SCOPES, state.toString());\n  res.writeHead(301, {\n    Location: authorizeURL\n  });\n  res.end();\n}","map":null,"metadata":{},"sourceType":"module"}